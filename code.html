<!DOCTYPE html>
<html>
<head>

<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="keywords" content="code">

<!--<link rel="stylesheet" href="stylesheet/style_main.css" type="text/css">
-->
<!--
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=desert"></script>
-->

<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
</head>

<title>sidecode/code - WIP</title>

<body>
  <input type="button" value="bgColor" onclick="bgcTest();"/>
  <input type="text" name="classname" id="classname" placeholder="Input ClassName here."/>
  <input type="button" value="h" onclick="hljs.initHighlighting();"/>
  <input type="button" value="border" onclick="testBorder();"/>
  <input type="button" value="closeF" onclick="testWindowClose();"/>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-dark.min.css">
  <link rel="stylesheet" href="stylesheet/style_view.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>


<pre id="hl_outer">
  <code id = "hl">
  #include &lt;stdio.h&gt;
  #include &lt;stdlib.h&gt;
  #define N 100
  int quizReader(QUIZ *quiz,int *n){
    struct _quiz{<input type="button" value="解説 - h1" onclick="start()"/>
      char question[100];
      char ans1[50];
      char ans2[50];
      int correct_ans;
    };
    typedef struct _quiz QUIZ;
    FILE *fp;
    n = 0;
    struct _quiz QUIZ;
    fp = fopen("quiz.txt","r");
    if(fp==NULL){<input type="button" value="解説 - h2" onclick="start2()"/>
      printf("invalid quiz file");
      return -1;
    }
    while(fscanf(fp,%[^,],%[^,],%[^,],%d),QUIZ[i].question,QUIZ[i].ans1,QUIZ[i].ans2,&QUIZ[i].correct_ans!=EOF){
    n=n+1;
  }
  return 0;
  }


</code>
</pre>

<script>
  window.addEventListener("load", function() {
    hljs.initHighlighting();
    hljs.initLineNumbersOnLoad();
  });
</script>

  <script src="https://riversun.github.io/jsframe/jsframe.js"></script>
  <script>
  //body内に記述すること
    const jsFrame = new JSFrame();
    function start() {

      // Create window
      //const frame = jsFrame.create({
      frameTester = jsFrame.create({
        name: 'test1',
        title: 'Window',
        left: 20, top: 60, width: 320, height: 220,
        border: {
        shadow: '2px 2px 10px  rgba(230, 0, 0, 0.5)',
        width: 1,
        radius: 6,
    },
        movable: true,// Enable to be moved  by mouse
        resizable: true,// Enable to be resized by mouse
        html: '<div id="my_element" style="padding:10px;font-size:20px;color:red;">Test - h1<br>これソース汚くならない？</div>'
      });

      frameTester.on('closeButton', 'click', (_frame, evt) => {
        console.log("closer");
                _frame.closeFrame();
            });

      // Show window
      frameTester.show();

    }

    function start2() {
    //  const jsFrame = new JSFrame();
      // Create window
      const frame = jsFrame.create({
        name: 'test2',
        title: 'Window',
        left: 20, top: 60, width: 320, height: 220,
        appearanceName: 'material',
        appearanceParam: {
          titleBar: {
              background: 'red',
              buttonColor: 'white',
        height: 30,
        fontSize: 14,
        buttonWidth: 36,
        buttonHeight: 16,
          buttons: [ // buttons on the right
            {
		//Set font-awesome fonts(https://fontawesome.com/icons?d=gallery&m=free)
    fa: 'fas fa-times',
                name: 'closeButton',
                visible: true // visibility when window is created.
            },
        ],
          },
        },
        movable: true,// Enable to be moved  by mouse
        resizable: true,// Enable to be resized by mouse
        html: '<div id="my_element" style="padding:10px;font-size:20px;color:darkgray;">Test - h2</div>'
      });

      // Show window
      frame.show();

    }

    //start();
  </script>
  <script>
  function bgcTest(){
    let classname = document.getElementById("classname").value;
    console.log(document.getElementsByClassName(classname).innerHTML);
    document.getElementsByClassName(classname).style.backgroundColor = "#ff0000";
  }

  function testBorder(){
    const topnum=6;
    //const topline = document.getElementsByClassName('hljs-ln-code');
    const queryTag = 'td[data-line-number="'+topnum+'"]';
    console.log("Q:"+queryTag);
    const topline = document.querySelectorAll(queryTag);
    console.log(topline);
    topline[topline.length-1].style.borderLeft="2px solid red";
  }


  function testWindowClose(){
    //const jsFrame = new JSFrame();
    console.log("exists:"+jsFrame.containsWindowName('test1'));
    let frameTester = jsFrame.getWindowByName('test1');
    console.log(frameTester);
    console.log(countRow(frameTester.innerHTML));
    frameTester.closeFrame();
  }

  function countRow(String){
    const text = "testtesttest"
    return ( text.match( /\n/g ) || [] ).length ;
  }

  sendHeight();

  function sendHeight(){
    let h = document.body.scrollHeight;
    console.log("send-M:"+h);
    parent.postMessage(h, "*");
  }

  </script>

  <style type="text/css">
  .hljs-ln td{
    padding-left:2px;
  }
  </style>

</body>
</html>
